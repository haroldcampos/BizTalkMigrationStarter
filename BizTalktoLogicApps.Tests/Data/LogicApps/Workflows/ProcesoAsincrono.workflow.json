{
  "kind": "Stateful",
  "definition": {
    "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
    "contentVersion": "1.0.0.0",
    "triggers": {
      "When_called_from_parent_workflow": {
        "type": "Request",
        "kind": "Http",
        "description": "Migrated from BizTalk WCF endpoint - BizTalk Adapter: HTTP",
        "metadata": {
          "biztalkTransportType": "HTTP"
        }
      }
    },
    "actions": {
      "estadoGeneracionPDF": {
        "type": "InitializeVariable",
        "inputs": {
          "variables": [
            {
              "name": "estadoGeneracionPDF",
              "type": "object",
              "value": null
            }
          ]
        },
        "runAfter": {}
      },
      "estaActivaDesglose": {
        "type": "InitializeVariable",
        "inputs": {
          "variables": [
            {
              "name": "estaActivaDesglose",
              "type": "boolean",
              "value": false
            }
          ]
        },
        "runAfter": {
          "estadoGeneracionPDF": [
            "SUCCEEDED"
          ]
        }
      },
      "estadoDesgloseICEPS": {
        "type": "InitializeVariable",
        "inputs": {
          "variables": [
            {
              "name": "estadoDesgloseICEPS",
              "type": "object",
              "value": null
            }
          ]
        },
        "runAfter": {
          "estaActivaDesglose": [
            "SUCCEEDED"
          ]
        }
      },
      "transicionPagos": {
        "type": "InitializeVariable",
        "inputs": {
          "variables": [
            {
              "name": "transicionPagos",
              "type": "object",
              "value": null
            }
          ]
        },
        "runAfter": {
          "estadoDesgloseICEPS": [
            "SUCCEEDED"
          ]
        }
      },
      "estaActivoPagos": {
        "type": "InitializeVariable",
        "inputs": {
          "variables": [
            {
              "name": "estaActivoPagos",
              "type": "boolean",
              "value": false
            }
          ]
        },
        "runAfter": {
          "transicionPagos": [
            "SUCCEEDED"
          ]
        }
      },
      "confirmaDesgloseICEPS": {
        "type": "InitializeVariable",
        "inputs": {
          "variables": [
            {
              "name": "confirmaDesgloseICEPS",
              "type": "object",
              "value": null
            }
          ]
        },
        "runAfter": {
          "estaActivoPagos": [
            "SUCCEEDED"
          ]
        }
      },
      "confirmaPagos": {
        "type": "InitializeVariable",
        "inputs": {
          "variables": [
            {
              "name": "confirmaPagos",
              "type": "object",
              "value": null
            }
          ]
        },
        "runAfter": {
          "confirmaDesgloseICEPS": [
            "SUCCEEDED"
          ]
        }
      },
      "transicionDWH": {
        "type": "InitializeVariable",
        "inputs": {
          "variables": [
            {
              "name": "transicionDWH",
              "type": "object",
              "value": null
            }
          ]
        },
        "runAfter": {
          "confirmaPagos": [
            "SUCCEEDED"
          ]
        }
      },
      "estaActivaDWH": {
        "type": "InitializeVariable",
        "inputs": {
          "variables": [
            {
              "name": "estaActivaDWH",
              "type": "boolean",
              "value": false
            }
          ]
        },
        "runAfter": {
          "transicionDWH": [
            "SUCCEEDED"
          ]
        }
      },
      "confirmaDWH": {
        "type": "InitializeVariable",
        "inputs": {
          "variables": [
            {
              "name": "confirmaDWH",
              "type": "object",
              "value": null
            }
          ]
        },
        "runAfter": {
          "estaActivaDWH": [
            "SUCCEEDED"
          ]
        }
      },
      "estaActivoEnvioEventHub": {
        "type": "InitializeVariable",
        "inputs": {
          "variables": [
            {
              "name": "estaActivoEnvioEventHub",
              "type": "boolean",
              "value": false
            }
          ]
        },
        "runAfter": {
          "confirmaDWH": [
            "SUCCEEDED"
          ]
        }
      },
      "transicionEnvioBlob": {
        "type": "InitializeVariable",
        "inputs": {
          "variables": [
            {
              "name": "transicionEnvioBlob",
              "type": "object",
              "value": null
            }
          ]
        },
        "runAfter": {
          "estaActivoEnvioEventHub": [
            "SUCCEEDED"
          ]
        }
      },
      "confirmaEnvioBlob": {
        "type": "InitializeVariable",
        "inputs": {
          "variables": [
            {
              "name": "confirmaEnvioBlob",
              "type": "object",
              "value": null
            }
          ]
        },
        "runAfter": {
          "transicionEnvioBlob": [
            "SUCCEEDED"
          ]
        }
      },
      "MsgRecepcionSinc": {
        "type": "InitializeVariable",
        "inputs": {
          "variables": [
            {
              "name": "MsgRecepcionSinc",
              "type": "object",
              "value": null
            }
          ]
        },
        "runAfter": {
          "confirmaEnvioBlob": [
            "SUCCEEDED"
          ]
        }
      },
      "acuse": {
        "type": "InitializeVariable",
        "inputs": {
          "variables": [
            {
              "name": "acuse",
              "type": "object",
              "value": null
            }
          ]
        },
        "runAfter": {
          "MsgRecepcionSinc": [
            "SUCCEEDED"
          ]
        }
      },
      "encabezado": {
        "type": "InitializeVariable",
        "inputs": {
          "variables": [
            {
              "name": "encabezado",
              "type": "object",
              "value": null
            }
          ]
        },
        "runAfter": {
          "acuse": [
            "SUCCEEDED"
          ]
        }
      },
      "esReproceso": {
        "type": "InitializeVariable",
        "inputs": {
          "variables": [
            {
              "name": "esReproceso",
              "type": "boolean",
              "value": false
            }
          ]
        },
        "runAfter": {
          "encabezado": [
            "SUCCEEDED"
          ]
        }
      },
      "Inicializar_Variables": {
        "type": "Compose",
        "inputs": "@'Sat.DyP.Herramientas.Datos.Bootstrapping.SqlTopazBootstrapper.CargarConfiguracionSqlRetry();\r\n\r\nestaActivaDesglose = false;\r\n\r\nestaActivoPagos = false;\r\n\r\nestaActivaDWH = false;\r\n\r\nestaActivoEnvioEventHub = false'",
        "runAfter": {
          "esReproceso": [
            "SUCCEEDED"
          ]
        }
      },
      "Flujo_proceso_asincrono": {
        "type": "Scope",
        "actions": {
          "Obtiene_estatus_de_la_transacción": {
            "type": "Compose",
            "inputs": "@'Sat.DyP.Herramientas.Datos.Bootstrapping.SqlTopazBootstrapper.CargarConfiguracionSqlRetry();\r\n\r\nestaActivaDesglose = System.Convert.ToBoolean\r\n(\r\n    System.Convert.ToInt16\r\n    (\r\n        Sat.DyP.Herramientas.Configuracion.ConfiguracionApp.AdaptadorDefault.BuscarConfiguracion\r\n        (\r\n            Sat.DyP.Core.Modelo.ConstantesProcesamiento.DESGLOSEICEPSACTIVA\r\n        )\r\n    )\r\n);\r\n\r\nSat.DyP.Herramientas.Diagnostico.AccesoLogEventos.EscribirEntradaInformation(\"estaActivaDesglose = \" + estaActivaDesglose.ToString(), \r\n                                                                       Sat.DyP.Herramientas.Diagnostico.IdentificadoresLogEventos.Procesamiento);\r\n\r\nestaActivoPagos = System.Convert.ToBoolean\r\n(\r\n    System.Convert.ToInt16\r\n    (\r\n        Sat.DyP.Herramientas.Configuracion.ConfiguracionApp.AdaptadorDefault.BuscarConfiguracion\r\n        (\r\n            Sat.DyP.Core.Modelo.ConstantesProcesamiento.PAGOSACTIVO\r\n        )\r\n    )\r\n);\r\n\r\nSat.DyP.Herramientas.Diagnostico.AccesoLogEventos.EscribirEntradaInformation(\"estaActivoPagos = \" + estaActivoPagos.ToString(), \r\n                                                                       Sat.DyP.Herramientas.Diagnostico.IdentificadoresLogEventos.Procesamiento);\r\n\r\nestaActivaDWH = System.Convert.ToBoolean\r\n(\r\n    System.Convert.ToInt16\r\n    (\r\n        Sat.DyP.Herramientas.Configuracion.ConfiguracionApp.AdaptadorDefault.BuscarConfiguracion\r\n        (\r\n            Sat.DyP.Core.Modelo.ConstantesProcesamiento.DWHACTIVA\r\n        )\r\n    )\r\n);\r\n\r\nSat.DyP.Herramientas.Diagnostico.AccesoLogEventos.EscribirEntradaInformation(\"estaActivaDWH = \" + estaActivaDWH.ToString(), \r\n                                                                       Sat.DyP.Herramientas.Diagnostico.IdentificadoresLogEventos.Procesamiento);\r\n\r\nestaActivoEnvioEventHub = System.Convert.ToBoolean\r\n(\r\n    System.Convert.ToInt16\r\n    (\r\n        Sat.DyP.Herramientas.Configuracion.ConfiguracionApp.AdaptadorDefault.BuscarConfiguracion\r\n        (\r\n            Sat.DyP.Core.Modelo.ConstantesProcesamiento.ENVIOEVENTHUBACTIVO\r\n        )\r\n    )\r\n);\r\n\r\nSat.DyP.Herramientas.Diagnostico.AccesoLogEventos.EscribirEntradaInformation(\"estaActivoEnvioEventHub = \" + estaActivoEnvioEventHub.ToString(), \r\n                                                                       Sat.DyP.Herramientas.Diagnostico.IdentificadoresLogEventos.Procesamiento);\r\n\r\n\r\nSat.DyP.Core.Dominio.ProcesamientoAsincronoCD.InsertaTrnExt\r\n(\r\n    encabezado, \r\n    esReproceso, \r\n    estaActivaDesglose, \r\n    estaActivoPagos,\r\n    estaActivaDWH,\r\n    estaActivoEnvioEventHub,\r\n    acuse.FechaRecepcion.ToString(),\r\n    out estadoGeneracionPDF, \r\n    out transicionPagos,\r\n    out estadoDesgloseICEPS, \r\n    out transicionDWH,\r\n    out transicionEnvioBlob\r\n);\r\n\r\nconfirmaDesgloseICEPS.Estado = estadoDesgloseICEPS.Estado;\r\nSat.DyP.Herramientas.Diagnostico.AccesoLogEventos.EscribirEntradaInformation(\"confirmaDesgloseICEPS.Estado = \" + estadoDesgloseICEPS.Estado.ToString(), \r\n                                                                       Sat.DyP.Herramientas.Diagnostico.IdentificadoresLogEventos.Procesamiento);\r\n\r\nconfirmaPagos.Estado = transicionPagos.Estado;\r\nSat.DyP.Herramientas.Diagnostico.AccesoLogEventos.EscribirEntradaInformation(\"confirmaPagos.Estado = \" + transicionPagos.Estado.ToString(), \r\n                                                                       Sat.DyP.Herramientas.Diagnostico.IdentificadoresLogEventos.Procesamiento);\r\nconfirmaDWH.Estado = transicionDWH.Estado;\r\nSat.DyP.Herramientas.Diagnostico.AccesoLogEventos.EscribirEntradaInformation(\"confirmaDWH.Estado = \" + transicionDWH.Estado.ToString(), \r\n                                                                       Sat.DyP.Herramientas.Diagnostico.IdentificadoresLogEventos.Procesamiento);\r\nconfirmaEnvioBlob.Estado = transicionEnvioBlob.Estado;\r\nSat.DyP.Herramientas.Diagnostico.AccesoLogEventos.EscribirEntradaInformation(\"confirmaEnvioBlob.Estado = \" + confirmaEnvioBlob.Estado.ToString(), \r\n                                                                       Sat.DyP.Herramientas.Diagnostico.IdentificadoresLogEventos.Procesamiento)'",
            "runAfter": {}
          },
          "GeneraDeclaracionFileShare": {
            "type": "Scope",
            "actions": {
              "PDF_Declaracion_Generado_cb238a4a": {
                "type": "If",
                "expression": "@'estadoGeneracionPDF.Estado == Sat.DyP.Core.Modelo.EstadoMensajeAppExternas.Reproceso || \r\nestadoGeneracionPDF.Estado == Sat.DyP.Core.Modelo.EstadoMensajeAppExternas.SinEnviar || \r\n(\r\n    estadoGeneracionPDF.Estado == Sat.DyP.Core.Modelo.EstadoMensajeAppExternas.Error \r\n    && esReproceso\r\n)'",
                "actions": {
                  "GeneraDeclaracionFS_24876a58": {
                    "type": "Compose",
                    "inputs": "@'Sat.DyP.Herramientas.Datos.Bootstrapping.SqlTopazBootstrapper.CargarConfiguracionSqlRetry();\r\n\r\n//Sat.DyP.Herramientas.Diagnostico.AccesoLogEventos.EscribirEntradaInformation(\"Debe generar el Acuse\", \r\n//                                                                       Sat.DyP.Herramientas.Diagnostico.IdentificadoresLogEventos.Procesamiento);\r\n\r\n\r\n\r\nestadoGeneracionPDF = Sat.DyP.Core.Dominio.ProcesamientoAsincronoCD.GenerarDocumentoPDF\r\n(\r\n    encabezado,\r\n    esReproceso,\r\n    estadoGeneracionPDF,\r\n    MsgRecepcionSinc,\r\n    acuse.FechaRecepcion.ToString()\r\n)'",
                    "runAfter": {}
                  }
                },
                "else": {
                  "actions": {}
                },
                "runAfter": {}
              }
            },
            "runAfter": {
              "Obtiene_estatus_de_la_transacción": [
                "SUCCEEDED"
              ]
            }
          },
          "Envío_de_XML_a_blob_Storage": {
            "type": "Scope",
            "actions": {
              "Enviado_a__eventhub_6e5e040c": {
                "type": "If",
                "expression": "@'estaActivoEnvioEventHub && \r\n(\r\n    transicionEnvioBlob.Estado == Sat.DyP.Core.Modelo.EstadoMensajeAppExternas.Reproceso || \r\n    transicionEnvioBlob.Estado == Sat.DyP.Core.Modelo.EstadoMensajeAppExternas.SinEnviar || \r\n    (\r\n        transicionEnvioBlob.Estado == Sat.DyP.Core.Modelo.EstadoMensajeAppExternas.Error \r\n        && esReproceso\r\n    )\r\n)'",
                "actions": {
                  "Envia_a_blob_01656f4c": {
                    "type": "Compose",
                    "inputs": "@'//Sat.DyP.Herramientas.Diagnostico.AccesoLogEventos.EscribirEntradaInformation(\"Debe generar el Acuse\", \r\n//                                                                       Sat.DyP.Herramientas.Diagnostico.IdentificadoresLogEventos.Procesamiento);\r\n\r\nconfirmaEnvioBlob = Sat.DyP.Core.Dominio.ProcesamientoAsincronoCD.EnviarEventHub\r\n(\r\n    MsgRecepcionSinc,\r\n    esReproceso,\r\n    transicionEnvioBlob,\r\n    encabezado,    \r\n    acuse\r\n)'",
                    "runAfter": {}
                  }
                },
                "else": {
                  "actions": {}
                },
                "runAfter": {}
              }
            },
            "runAfter": {
              "GeneraDeclaracionFileShare": [
                "SUCCEEDED"
              ]
            }
          },
          "Desglose_de_ICEPS": {
            "type": "Scope",
            "actions": {
              "Generar_Desglose_de_ICEPS_0204f4c4": {
                "type": "If",
                "expression": "@'estaActivaDesglose && \r\n(\r\n    estadoDesgloseICEPS.Estado == Sat.DyP.Core.Modelo.EstadoMensajeAppExternas.Reproceso || \r\n    estadoDesgloseICEPS.Estado == Sat.DyP.Core.Modelo.EstadoMensajeAppExternas.SinEnviar || \r\n    (\r\n        estadoDesgloseICEPS.Estado == Sat.DyP.Core.Modelo.EstadoMensajeAppExternas.Error && \r\n        esReproceso\r\n    )\r\n)'",
                "actions": {
                  "DesgloseICEPS_3648df45": {
                    "type": "Compose",
                    "inputs": "@'Sat.DyP.Herramientas.Datos.Bootstrapping.SqlTopazBootstrapper.CargarConfiguracionSqlRetry();\r\n\r\nSat.DyP.Herramientas.Diagnostico.AccesoLogEventos.EscribirEntradaInformation(\"Debe generar el Desglose\", \r\n                                                                       Sat.DyP.Herramientas.Diagnostico.IdentificadoresLogEventos.Procesamiento);\r\n\r\n\r\n\r\nconfirmaDesgloseICEPS = Sat.DyP.Core.Dominio.ProcesamientoAsincronoCD.AlmacenarDesgloseICEPS\r\n(\r\n    encabezado,\r\n    esReproceso,\r\n    estadoDesgloseICEPS,\r\n    MsgRecepcionSinc,\r\n    confirmaDesgloseICEPS,\r\n    acuse.FechaRecepcion.ToString()\r\n);\r\n\r\n\r\nSat.DyP.Herramientas.Diagnostico.AccesoLogEventos.EscribirEntradaInformation(\"Después de generar el Desglose\", \r\n                                                                       Sat.DyP.Herramientas.Diagnostico.IdentificadoresLogEventos.Procesamiento)'",
                    "runAfter": {}
                  }
                },
                "else": {
                  "actions": {}
                },
                "runAfter": {}
              }
            },
            "runAfter": {
              "Obtiene_estatus_de_la_transacción": [
                "SUCCEEDED"
              ]
            }
          },
          "Decide_1_925f0743": {
            "type": "If",
            "expression": "@equals(variables('confirmaDesgloseICEPS')?['Estado'], 'Exito')",
            "actions": {
              "Envío_Pagos_05f33d70": {
                "type": "Scope",
                "actions": {
                  "Se_enviará_a_Pagos_c5e34a71": {
                    "type": "If",
                    "expression": "@'estaActivoPagos && \r\n(\r\n    transicionPagos.Estado == Sat.DyP.Core.Modelo.EstadoMensajeAppExternas.Reproceso || \r\n    transicionPagos.Estado == Sat.DyP.Core.Modelo.EstadoMensajeAppExternas.SinEnviar || \r\n    (\r\n        transicionPagos.Estado == Sat.DyP.Core.Modelo.EstadoMensajeAppExternas.Error && \r\n        esReproceso\r\n    )\r\n)'",
                    "actions": {
                      "Envío_a_Pagos_ddfba7ac": {
                        "type": "Compose",
                        "inputs": "@'Sat.DyP.Herramientas.Datos.Bootstrapping.SqlTopazBootstrapper.CargarConfiguracionSqlRetry();\r\n\r\nSat.DyP.Herramientas.Diagnostico.AccesoLogEventos.EscribirEntradaInformation(\"Debe enviar a pagos\", \r\n                                                                       Sat.DyP.Herramientas.Diagnostico.IdentificadoresLogEventos.Procesamiento);\r\n\r\n\r\n\r\nconfirmaPagos = Sat.DyP.Core.Dominio.ProcesamientoAsincronoCD.EnviarPagos\r\n(\r\n    MsgRecepcionSinc, \r\n    esReproceso,\r\n    transicionPagos,\r\n    encabezado,\r\n    confirmaPagos,\r\n    acuse.FechaRecepcion.ToString()\r\n);\r\n\r\n\r\nSat.DyP.Herramientas.Diagnostico.AccesoLogEventos.EscribirEntradaInformation(\"Después de enviar a pagos\", \r\n                                                                       Sat.DyP.Herramientas.Diagnostico.IdentificadoresLogEventos.Procesamiento)'",
                        "runAfter": {}
                      }
                    },
                    "else": {
                      "actions": {}
                    },
                    "runAfter": {}
                  }
                },
                "runAfter": {}
              }
            },
            "else": {
              "actions": {}
            },
            "runAfter": {
              "Desglose_de_ICEPS": [
                "SUCCEEDED"
              ]
            }
          },
          "EnviaDWH": {
            "type": "Scope",
            "actions": {
              "Envía_a_DWH_31ce7170": {
                "type": "If",
                "expression": "@'estaActivaDWH && \r\n(\r\n    transicionDWH.Estado == Sat.DyP.Core.Modelo.EstadoMensajeAppExternas.Reproceso || \r\n    transicionDWH.Estado == Sat.DyP.Core.Modelo.EstadoMensajeAppExternas.SinEnviar ||\r\n    (\r\n        transicionDWH.Estado == Sat.DyP.Core.Modelo.EstadoMensajeAppExternas.Error && \r\n        esReproceso\r\n    )\r\n)'",
                "actions": {
                  "EnviaDeclaracionDWH_5b3c529e": {
                    "type": "Compose",
                    "inputs": "@'Sat.DyP.Herramientas.Datos.Bootstrapping.SqlTopazBootstrapper.CargarConfiguracionSqlRetry();\r\n\r\nSat.DyP.Herramientas.Diagnostico.AccesoLogEventos.EscribirEntradaInformation(\"Enviar al data\", \r\n                                                                       Sat.DyP.Herramientas.Diagnostico.IdentificadoresLogEventos.Procesamiento);\r\n\r\n\r\n\r\nconfirmaDWH = Sat.DyP.Core.Dominio.ProcesamientoAsincronoCD.EnviarDWH\r\n(\r\n    MsgRecepcionSinc, \r\n    esReproceso,\r\n    transicionDWH,\r\n    encabezado,\r\n    confirmaDWH,\r\n    acuse.FechaRecepcion.ToString()\r\n)'",
                    "runAfter": {}
                  }
                },
                "else": {
                  "actions": {}
                },
                "runAfter": {}
              }
            },
            "runAfter": {
              "Obtiene_estatus_de_la_transacción": [
                "SUCCEEDED"
              ]
            }
          },
          "Envios_en_paralelo_Join": {
            "type": "Compose",
            "inputs": {
              "parallelBranchesCompleted": true,
              "branchCount": 3
            },
            "runAfter": {
              "Envío_de_XML_a_blob_Storage": [
                "SUCCEEDED"
              ],
              "Decide_1_925f0743": [
                "SUCCEEDED"
              ],
              "EnviaDWH": [
                "SUCCEEDED"
              ]
            }
          },
          "suspende_orqestacion": {
            "type": "Scope",
            "actions": {
              "Exisitió_algún_error_18d5e3dc": {
                "type": "If",
                "expression": "@'(\r\n    (\r\n        confirmaDWH.Estado == Sat.DyP.Core.Modelo.EstadoMensajeAppExternas.Reproceso ||\r\n        confirmaDWH.Estado == Sat.DyP.Core.Modelo.EstadoMensajeAppExternas.SinEnviar\r\n    ) && estaActivaDWH\r\n) ||\r\nestadoGeneracionPDF.Estado == Sat.DyP.Core.Modelo.EstadoMensajeAppExternas.Reproceso ||\r\nestadoGeneracionPDF.Estado == Sat.DyP.Core.Modelo.EstadoMensajeAppExternas.SinEnviar ||\r\nconfirmaDesgloseICEPS.Estado == Sat.DyP.Core.Modelo.EstadoMensajeAppExternas.Reproceso ||\r\nconfirmaDesgloseICEPS.Estado == Sat.DyP.Core.Modelo.EstadoMensajeAppExternas.SinEnviar ||\r\n(\r\n    (\r\n        confirmaPagos.Estado == Sat.DyP.Core.Modelo.EstadoMensajeAppExternas.Reproceso ||\r\n        confirmaPagos.Estado == Sat.DyP.Core.Modelo.EstadoMensajeAppExternas.SinEnviar\r\n    ) && \r\n    estaActivoPagos \r\n)'",
                "actions": {
                  "SuspendeOrquestacion_34c77edf": {
                    "type": "Terminate",
                    "inputs": {
                      "runStatus": "Failed",
                      "runError": {
                        "code": "Terminated",
                        "message": "System.String.Format(@\"Se suspende la orquestación asíncrona por estatus:\\n((confirmaDWH.Estado ({0}) == Reproceso || confirmaDWH.Estado ({0})== SinEnviar) && estaActivaDWH ({1})) ||estadoGeneracionPDF.Estado ({2}) == Reproceso ||estadoGeneracionPDF.Estado ({2}) == SinEnviar ||confirmaDesgloseICEPS.Estado ({3}) == Reproceso ||confirmaDesgloseICEPS.Estado ({3}) == SinEnviar ||((confirmaPagos.Estado ({4}) == Reproceso ||confirmaPagos.Estado ({4}) == SinEnviar) && estaActivoPagos ({5}))\\nIddeclaracion: {6}\", \r\nconfirmaDWH.Estado,\r\nestaActivaDWH,\r\nestadoGeneracionPDF.Estado,\r\nconfirmaDesgloseICEPS.Estado,\r\nconfirmaPagos.Estado,\r\nestaActivoPagos,\r\nencabezado.IdDeclaracion\r\n);"
                      }
                    },
                    "runAfter": {}
                  }
                },
                "else": {
                  "actions": {}
                },
                "runAfter": {}
              }
            },
            "runAfter": {
              "Envios_en_paralelo_Join": [
                "SUCCEEDED"
              ]
            }
          },
          "Excepcion_Plataforma": {
            "type": "Scope",
            "actions": {
              "Escribe_en_log_la_excepcion": {
                "type": "Compose",
                "inputs": "@'Sat.DyP.Herramientas.Datos.Bootstrapping.SqlTopazBootstrapper.CargarConfiguracionSqlRetry();\r\n\r\nSat.DyP.Herramientas.Diagnostico.AccesoLogEventos.EscribirEntradaError(ExcepcionPlataforma.Message, \r\n                                                                       Sat.DyP.Herramientas.Diagnostico.IdentificadoresLogEventos.Procesamiento);\r\nSat.DyP.Herramientas.Diagnostico.AccesoLogEventos.EscribirEntradaError(ExcepcionPlataforma.StackTrace, \r\n                                                                       Sat.DyP.Herramientas.Diagnostico.IdentificadoresLogEventos.Procesamiento)'",
                "runAfter": {}
              },
              "Suspende_error_de_plataforma": {
                "type": "Terminate",
                "inputs": {
                  "runStatus": "Failed",
                  "runError": {
                    "code": "Terminated",
                    "message": "System.String.Format(\"Proceso suspendidio porque hubo un error dentro del procesamiento asincrono\");"
                  }
                },
                "runAfter": {
                  "Escribe_en_log_la_excepcion": [
                    "SUCCEEDED"
                  ]
                }
              }
            },
            "runAfter": {
              "suspende_orqestacion": [
                "FAILED",
                "TIMEDOUT",
                "SKIPPED"
              ]
            }
          },
          "ExcepcionGenerica": {
            "type": "Scope",
            "actions": {
              "Escribe_en_log_la_excepcion_1": {
                "type": "Compose",
                "inputs": "@'Sat.DyP.Herramientas.Datos.Bootstrapping.SqlTopazBootstrapper.CargarConfiguracionSqlRetry();\r\n\r\nSat.DyP.Herramientas.Diagnostico.AccesoLogEventos.EscribirEntradaError(ExcepcionGenerica.Message, \r\n                                                                       Sat.DyP.Herramientas.Diagnostico.IdentificadoresLogEventos.Procesamiento);\r\nSat.DyP.Herramientas.Diagnostico.AccesoLogEventos.EscribirEntradaError(ExcepcionGenerica.StackTrace, \r\n                                                                       Sat.DyP.Herramientas.Diagnostico.IdentificadoresLogEventos.Procesamiento)'",
                "runAfter": {}
              },
              "Suspende_error_excepción_generica": {
                "type": "Terminate",
                "inputs": {
                  "runStatus": "Failed",
                  "runError": {
                    "code": "Terminated",
                    "message": "System.String.Format\r\n(\r\n    \"Proceso suspendidio porque hubo un error dentro del procesamiento asincrono: {0}\", \r\n    ExcepcionGenerica.Message\r\n);"
                  }
                },
                "runAfter": {
                  "Escribe_en_log_la_excepcion_1": [
                    "SUCCEEDED"
                  ]
                }
              }
            },
            "runAfter": {
              "suspende_orqestacion": [
                "FAILED",
                "TIMEDOUT",
                "SKIPPED"
              ]
            }
          }
        },
        "runAfter": {
          "Inicializar_Variables": [
            "SUCCEEDED"
          ]
        }
      },
      "DefaultSendPort": {
        "type": "ServiceProvider",
        "inputs": {
          "parameters": {
            "entityName": "queue",
            "message": "@triggerBody()",
            "sessionId": "",
            "contentType": "application/json"
          },
          "serviceProviderConfiguration": {
            "connectionName": "servicebus",
            "operationId": "sendMessage",
            "serviceProviderId": "/serviceProviders/serviceBus"
          }
        },
        "runAfter": {
          "Flujo_proceso_asincrono": [
            "SUCCEEDED"
          ]
        }
      }
    },
    "outputs": {}
  }
}